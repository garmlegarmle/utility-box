---
import { LANGS } from '../../consts';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getOtherLang, isSupportedLang } from '../../lib/content';

export function getStaticPaths() {
  return LANGS.map((lang) => ({ params: { lang } }));
}

const lang = Astro.params.lang as string;
if (!isSupportedLang(lang)) {
  throw new Error(`Unsupported language: ${lang}`);
}

const otherLang = getOtherLang(lang);
const labels =
  lang === 'ko'
    ? {
        title: '공지 게시판',
        intro: '전체 공지와 업데이트를 확인할 수 있습니다.',
        newPost: '새 글 쓰기',
        list: '글 목록',
        empty: '등록된 글이 없습니다.',
        loading: '불러오는 중...'
      }
    : {
        title: 'Notice Board',
        intro: 'Read all notices and updates.',
        newPost: 'Write Post',
        list: 'Posts',
        empty: 'No posts yet.',
        loading: 'Loading...'
      };
---
<BaseLayout
  title={labels.title}
  description={labels.intro}
  lang={lang}
  activeNav="blog"
  languageToggleHref={`/${otherLang}/notice/`}
  canonicalPath={`/${lang}/notice/`}
  alternates={[
    { lang: 'en', href: '/en/notice/' },
    { lang: 'ko', href: '/ko/notice/' }
  ]}
>
  <section class="page-section">
    <div class="container notice-board" data-notice-board data-lang={lang}>
      <header class="notice-board__head">
        <div>
          <h1>{labels.title}</h1>
          <p>{labels.intro}</p>
        </div>
        <button class="notice-board__new-btn" type="button" data-action="create" hidden>
          {labels.newPost}
        </button>
      </header>

      <div class="notice-board__layout">
        <aside class="notice-board__list">
          <h2>{labels.list}</h2>
          <p class="notice-board__state" data-role="list-state">{labels.loading}</p>
          <ul data-role="post-list"></ul>
        </aside>

        <article class="notice-board__detail" data-role="detail">
          <p class="notice-board__state">{labels.empty}</p>
        </article>
      </div>
    </div>
  </section>
  <script src="/posts-ui.js" defer></script>
</BaseLayout>
