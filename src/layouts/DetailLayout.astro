---
import BaseLayout from './BaseLayout.astro';
import type { SiteLang } from '../consts';

interface AlternateLink {
  lang: SiteLang;
  href: string;
}

interface Props {
  lang: SiteLang;
  title: string;
  description: string;
  canonicalPath: string;
  languageToggleHref: string;
  alternates: AlternateLink[];
  leadTag?: string;
  programSrc?: string;
  programAlt?: string;
  showProgramSlot?: boolean;
  activeNav?: 'home' | 'blog' | 'tools' | 'games';
  contentFile?: string;
}

const {
  lang,
  title,
  description,
  canonicalPath,
  languageToggleHref,
  alternates,
  leadTag,
  programSrc,
  programAlt,
  showProgramSlot = false,
  activeNav,
  contentFile
} = Astro.props;
---
<BaseLayout
  title={title}
  description={description}
  lang={lang}
  activeNav={activeNav}
  languageToggleHref={languageToggleHref}
  canonicalPath={canonicalPath}
  alternates={alternates}
>
  <article class="page-section" data-admin-page-file={contentFile}>
    <div class="container detail-layout">
      <header class="detail-layout__head">
        {leadTag && <p class="detail-layout__tag">{leadTag}</p>}
        <div class="detail-layout__title-row">
          <h1>{title}</h1>
          {
            contentFile && (
              <button
                type="button"
                class="admin-edit-trigger admin-edit-trigger--page"
                data-admin-file={contentFile}
                aria-label={`Edit ${title}`}
              >
                +
              </button>
            )
          }
        </div>
      </header>

      {
        showProgramSlot && (
          <section class="detail-program" aria-label={lang === 'ko' ? '프로그램 영역' : 'Program area'}>
            {programSrc ? (
              <img src={programSrc} alt={programAlt ?? title} loading="lazy" decoding="async" />
            ) : (
              <div class="detail-program__placeholder">{lang === 'ko' ? '도구/게임 영역' : 'Tool / Game Area'}</div>
            )}
          </section>
        )
      }

      <section class="detail-layout__content content-prose">
        <slot />
      </section>
    </div>
  </article>
</BaseLayout>
