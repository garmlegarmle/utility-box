---
interface Props {
  src: string;
  alt: string;
  caption?: string;
  ratio?: '1:1' | '4:3' | '16:9';
}

const { src, alt, caption, ratio = '4:3' } = Astro.props;
const ratioClass = ratio === '1:1' ? 'ratio-1-1' : ratio === '16:9' ? 'ratio-16-9' : 'ratio-4-3';
const isVideoMedia = /\.(mp4|webm|ogg)$/i.test(src);
---
<figure>
  <div class={`builder-media-frame ${ratioClass}`}>
    {isVideoMedia ? (
      <video controls playsinline preload="metadata">
        <source src={src} />
        {alt}
      </video>
    ) : (
      <img src={src} alt={alt} loading="lazy" decoding="async" />
    )}
  </div>
  {caption && <figcaption class="builder-caption">{caption}</figcaption>}
</figure>
